<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>订阅发布模式</title>
</head>
<body>
  <script>
    class Emitter {
      constructor(){
        this.listener = {}
      }
      // 订阅方法
      subscribe(key,fn){
        if(!this.listener[key]){
          this.listener[key] = []
        }
        this.listener[key].push(fn)
      }
      // 发布方法
      publish(key){
        let arr = this.listener[key];
        if(arr){
          arr.map((item,index)=>arr[index]())
        }
      }
      // 取消订阅
      remove(key){
        for(var i = 0; i < listener.length; i++){
          if(this.listener[i] == key){
            this.listener.splice(i,1);
            return
          }
        }
       
      }

    }
    let type = new Emitter();
    type.subscribe('类型一',()=>{console.log('sub1')});
    type.subscribe('类型一',()=>{console.log('sub2')});
    type.subscribe('类型一',()=>{console.log('sub3')});
    document.onclick = ()=>type.publish('类型一');
    setTimeout(()=>type.remove('类型一'));

  </script>
</body>
</html>